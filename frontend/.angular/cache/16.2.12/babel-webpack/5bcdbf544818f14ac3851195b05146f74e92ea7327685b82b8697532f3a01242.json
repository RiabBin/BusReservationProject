{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nfunction BusResultsComponent_div_0_div_3_div_30_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵlistener(\"click\", function BusResultsComponent_div_0_div_3_div_30_div_1_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const seat_r6 = restoredCtx.$implicit;\n      const bus_r2 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.bookSeat(bus_r2.id, seat_r6));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r6 = ctx.$implicit;\n    i0.ɵɵclassProp(\"booked\", seat_r6.isBooked);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", seat_r6.seatNo, \" \");\n  }\n}\nfunction BusResultsComponent_div_0_div_3_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtemplate(1, BusResultsComponent_div_0_div_3_div_30_div_1_Template, 2, 3, \"div\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.selectedBusSeats);\n  }\n}\nfunction BusResultsComponent_div_0_div_3_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" No buses to show. Search to load results.\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction BusResultsComponent_div_0_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5)(2, \"h4\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 6);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 7);\n    i0.ɵɵtext(7, \"Cancellation policy\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 8)(9, \"div\")(10, \"strong\");\n    i0.ɵɵtext(11, \"Starting\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"small\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\")(17, \"strong\");\n    i0.ɵɵtext(18, \"Arrival\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"small\");\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(23, \"div\", 9)(24, \"div\", 10);\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"div\", 11);\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function BusResultsComponent_div_0_div_3_Template_button_click_28_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const bus_r2 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.viewSeats(bus_r2.id));\n    });\n    i0.ɵɵtext(29, \"VIEW SEATS\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(30, BusResultsComponent_div_0_div_3_div_30_Template, 2, 1, \"div\", 13);\n    i0.ɵɵtemplate(31, BusResultsComponent_div_0_div_3_div_31_Template, 2, 0, \"div\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bus_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(bus_r2.company);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", bus_r2.busName, \" \\u2022 \", bus_r2.busType, \"\");\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(bus_r2.startTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(bus_r2.boardingPoint);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(bus_r2.arrivalTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(bus_r2.droppingPoint);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\u09F3\", bus_r2.fare, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Seats Left: \", bus_r2.totalSeats - bus_r2.bookedSeats, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedBusId === bus_r2.id && ctx_r1.selectedBusSeats);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.buses || ctx_r1.buses.length == 0);\n  }\n}\nfunction BusResultsComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, BusResultsComponent_div_0_div_3_Template, 32, 11, \"div\", 3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" Total Buses Found: \", ctx_r0.buses.length, \" | Total Seats Available: \", ctx_r0.totalSeats(), \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.buses);\n  }\n}\nexport let BusResultsComponent = /*#__PURE__*/(() => {\n  class BusResultsComponent {\n    constructor(http) {\n      this.http = http;\n      this.buses = [];\n      this.seats = [];\n      this.selectedBusId = null;\n    }\n    viewSeats(busId) {\n      if (this.selectedBusId === busId) {\n        // Hide seats if clicked again\n        this.selectedBusId = null;\n        return;\n      }\n      this.selectedBusId = busId;\n      this.http.get(`https://localhost:57263/api/seats/Bus/${busId}`).subscribe({\n        next: res => this.seats = res,\n        error: err => console.error('Error fetching seats', err)\n      });\n    }\n    totalSeats() {\n      if (!this.buses || this.buses.length === 0) return 0;\n      return this.buses.reduce((sum, bus) => {\n        const seatsLeft = bus.totalSeats != null && bus.bookedSeats != null ? bus.totalSeats - bus.bookedSeats : 0;\n        return sum + seatsLeft;\n      }, 0);\n    }\n    static {\n      this.ɵfac = function BusResultsComponent_Factory(t) {\n        return new (t || BusResultsComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: BusResultsComponent,\n        selectors: [[\"app-bus-results\"]],\n        inputs: {\n          buses: \"buses\"\n        },\n        decls: 1,\n        vars: 1,\n        consts: [[\"class\", \"results\", 4, \"ngIf\"], [1, \"results\"], [1, \"summary\"], [\"class\", \"bus-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"bus-card\"], [1, \"left\"], [1, \"sub\"], [1, \"cancel\"], [1, \"center\"], [1, \"right\"], [1, \"fare\"], [1, \"seats\"], [1, \"view\", 3, \"click\"], [\"class\", \"seat-layout\", 4, \"ngIf\"], [\"class\", \"no-data\", 4, \"ngIf\"], [1, \"seat-layout\"], [\"class\", \"seat\", 3, \"booked\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"seat\", 3, \"click\"], [1, \"no-data\"]],\n        template: function BusResultsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵtemplate(0, BusResultsComponent_div_0_Template, 4, 3, \"div\", 0);\n          }\n          if (rf & 2) {\n            i0.ɵɵproperty(\"ngIf\", ctx.buses && ctx.buses.length);\n          }\n        },\n        dependencies: [i2.NgForOf, i2.NgIf],\n        styles: [\".results[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]{background:#f7f7f7;padding:10px 12px;border-radius:6px;margin-bottom:12px}.bus-card[_ngcontent-%COMP%]{display:flex;gap:12px;border:1px solid #eee;padding:12px;border-radius:8px;margin-bottom:10px;align-items:center}.left[_ngcontent-%COMP%]{width:30%}.center[_ngcontent-%COMP%]{width:45%;display:flex;justify-content:space-between}.right[_ngcontent-%COMP%]{width:25%;text-align:right}.fare[_ngcontent-%COMP%]{background:#fff;color:#e50019;font-weight:700;font-size:18px;padding:6px 10px;border-radius:6px;display:inline-block}.view[_ngcontent-%COMP%]{background:#e50019;color:#fff;border:none;padding:6px 10px;border-radius:6px;margin-top:8px}.cancel[_ngcontent-%COMP%]{color:#ff4d4f;font-size:12px}.no-data[_ngcontent-%COMP%]{text-align:center;color:#777;padding:20px}.seat-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,40px);gap:8px;margin-top:10px}.seat-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-align:center;padding:6px;border-radius:4px;background-color:#90ee90;cursor:pointer}.seat-grid[_ngcontent-%COMP%]   div.booked[_ngcontent-%COMP%]{background-color:tomato;color:#fff}\"]\n      });\n    }\n  }\n  return BusResultsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}